# 表达式

# 对话框
## Fidle name
协议字段树中选择一个协议字段。通过展开协议名，可以获得用于筛选该协议的字段名的列表。


**TCP**
```c
tcp.ack，Acknowledgment number

tcp.analysis，SEQ/ACK analysis

tcp.checksum，Checksum

tcp.flags，Flags
...
```


**IPv4**
```c
ip.addr，Source or Destination address

ip.checksum，Header checksum

ip.dst，Destination

ip.id，Identification
...
```


......


## Relation
从可用关系列表中选择一个关系。


```c
is present，一元关系，数据包中存在所选择字段即为真

==、!=、>、<、>=、<=、contains、matches、in，二元关系，输入一个值，可能还有一些范围信息
```


## Value
在“值”文本框中输入适当的值。该值还将指示选择字段名的值的类型(如字符串)。


## Predefined Values
一些协议字段具有预定义值可用。


## Search
允许搜索完整或部分字段名称或描述。支持正则表达式。


## Range
偏移:长度，一组整数或一组范围。




# 示例
## Frame
frame
```c
Frame

frame
```
frame.encap_type
```c
Encapsulation type

frame.encap_type == 1，Ethernet
```
frame.time_delta
```c
Time delta from previous captured frame

frame.time_delta <= 0.0001
```
frame.time_delta_displayed
```c
Time delta from previous displayed frame
```
frame.number
```c
Frame Number

frame.nubmer == 100
```
frame.len
```c
Frame length on the wire

frame.len <= 60
```
frame.cap_len
```c
Frame length stored into the capture file

frame.len <= 60
```
frame.marked
```c
Frame is marked in the GUI

frame.marked == 0，False
```
frame.ignored
```c
Frame is ignored by the dissectors

frame.ignored == 0，False
```
frame.protocols
```c
Protocols carried by this frame

frame.protocols == "eth:ethertype:arp"
frame.protocols == "eth:ethertype:ip:tcp"
frame.protocols == "eth:ethertype:ip:tcp:data"
frame.protocols == "eth:ethertype:ip:udp:data"
```
frame.coloring_rule.name

```c
The frame matched the coloring rule with this name

frame.coloring_rule.name == "ARP"
frame.coloring_rule.name == "TCP"
frame.coloring_rule.name == "UDP"
```
frame.coloring_rule.string
```c
The frame matched this coloring rule string

frame.coloring_rule.string == "arp"
frame.coloring_rule.string == "tcp"
frame.coloring_rule.string == "udp"
```
frame.packet_flags
```c
Packet flags

frame.packet_flags
frame.packet_flags_crc_error
frame.packet_flags_packet_too_error
frame.packet_flags_packet_too_short_error
```


## Ethernet II
eth
```c
Ethernet

eth
```
eth.addr
```c
Source or Destination Hardware Address

eth.addr == 01:00:2b:63:b3:32
```
eth.dst
```c
Destination Hardware Address

eth.dst == 01:00:2b:63:b3:32
```
eth.dst.lg
```c
Specifies if this is an locally administered or globally unique(IEEE assigned) address

eth.dst.lg == 0，Globally unique address(factory default)
eth.dst.lg == 1，Locally administered address(this is NOT the factory default)
```
eth.dst.ig
```c
Specifies if this is an individual(unicast) or group (broadcast/multicast) address

eth.dst.ig == 0，单播
eth.dst.ig == 1，组播
```
eth.src
```c
Source Hardware Address

eth.src == 01:00:2b:63:b3:32
```
eth.src.lg
```c
Specifies if this is an locally administered or globally unique(IEEE assigned) address

eth.src.lg == 0，Globally unique address(factory default)
eth.src.lg == 1，Locally administered address(this is NOT the factory default)
```
est.src.ig
```c
Specifies if this is an individual(unicast) or group (broadcast/multicast) address

eth.src.ig == 0，单播
eth.src.ig == 1，组播
```
eth.type
```c
Type

eth.type == 0x0800，IPv4
```
eth.fcs
```c
Frame check sequence
```
eth.fcs.status
```c
FCS Status
```
eth.fcs_bad
```c
Bad checksum
```
eth.len
```c
Length
```
eth.padding
```c
Padding

eth.padding
```
eth.trailer
```c
Trailer

eth.trailer
```


## ARP
arp
```c
Address Resolution Protocol

arp
```
arp.hw.type
```c
Hardware type

arp.hw.type == 1，Ethernet
```
arp.proto.type
```c
Protocol type

arp.proto.type == 0x0800，IPv4
```
arp.hw.size
```c
Hardware size

arp.hw.size == 6
```
arp.proto.size
```c
Protocol size

arp.proto.size == 4
```
arp.opcode
```c
Opcode

arp.opcode == 1，request
```
arp.isgratuitous
```c
Is gratuitous

arp.isgratuitous == 1，True
arp.isgratuitous == 0，False
```
arp.src.hw_mac
```c
Sender MAC address

arp.src.hw_mac == 01:00:2c:65:b2:32
```
arp.src.proto_ipv4
```c
Sender IP address

arp.src.proto_ipv4 == 10.1.1.1
```
arp.dst.hw_mac
```c
Target MAC address

arp.dst.hw_mac == 01:00:2c:65:b2:32
```
arp.dst.proto_ipv4
```c
Target IP address

arp.dst.proto_ipv4 == 10.1.1.1
```
arp.duplicate-address-detected
```c
Duplicate IP address configured
```
arp.duplicate-address-frame
```c
Frame showing earlier use of IP address
```
arp.packet-storm-detected
```c
ARP packet storm detected
```


## IPv4
ip
```c
Internet Protocol Version 4

ip
```
ip.version
```c
Version

ip.version == 4
```
ip.hdr_len
```c
Header Length

ip.hdr_len == 20
```
ip.dsfield
```c
Differentiated Services Field

ip.dsfield == 0x00
```
ip.dsfield.dscp
```c
Differentiated Services Codepoint

ip.dsfield.dscp == 0
```
ip.dsfield.ecn
```c
Explicit Congestion Notification

ip.dsfield.ecn == 0
```
ip.len
```c
Total Length

ip.len <= 60
```
ip.id
```c
Identification

ip.id == 0x0000
```
ip.flags
```c
Flags

ip.flags == 0x4000，Don't fragment
```
ip.flags.rb
```c
Reserved bit

ip.flags.rb == 0，Not set
```
ip.flags.df
```c
Don't fragment
    
ip.flags.df == 1
```
ip.flags.mf
```c
More fragments

ip.flags.mf == 0，Not set
```
ip.frag_offset
```c
Fragment offset

ip.frag_offset == 0
```
ip.ttl
```c
Time to live

ip.ttl <= 60
```
ip.proto
```c
Protocol

ip.proto == 6，TCP
ip.proto == 17，UDP
```
ip.checksum
```c
Header checksum

ip.checksum == 0xef15
```
ip.src
```c
Source

ip.src == 10.1.1.1
```
ip.dst
```c
Destination

ip.dst == 10.1.1.1
```
ip.fragment
```c
ip.fragment · IPv4 Fragment
ip.fragment.count · Fragment
ip.fragment.error · Defragmentation error
```
ip.fragments
```c
IPv4 Fragments
```
ip.opt
```c
ip.opt.addr · IP Address
ip.opt.flag · Flag
ip.opt.id_number · ID Number
ip.opt.len · Length
ip.opt.mtu · MTU
ip.opt.padding · Padding
ip.opt.sid · Stream Identifier
ip.opt.type · Type
```
ip.reassembled
```c
ip.reassembled.data · Reassembled IPv4 data
ip.reassembled.length · Reassembled IPv4 length
ip.reassembled_in · Reassembled IPv4 in frame
```


## IPv6




## TCP
tcp
```c
Transmission Control Protocol

tcp
```
tcp.srcport
```c
Source Port

tcp.srcport == 62315
```
tcp.dstport
```c
Destination Port

tcp.dstport == 443
```
tcp.stream
```c
Stream index

tcp.stream == 0
```
tcp.len
```c
TCP Segment Len

tcp.len == 29
```
tcp.seq
```c
Sequence number

tcp.seq == 95672
```
tcp.seq_raw
```c
The raw value of the sequence number

tcp.seq_raw == 1696880154
```
tcp.nxtseq
```c
Next sequence number

tcp.nxtseq == 95701
```
tcp.ack
```c
Acknowledgment number

tcp.ack == 3040
```
tcp.ack_raw
```c
The raw value of the acknowledgment number

tcp.ack_raw == 1784144095
```
tcp.ack.nonzero
```c
The acknowledgment number field is nonzero while the ACK flag is not set
```
tcp.hdr_len
```c
Header Length

tcp.hdr_len == 20
```
tcp.flags
```c
Flags

tcp.flags == 0x010
```
tcp.flags.res
```c
Three reserved bits(must be zero)

tcp.flags.res == 0，Not set
```
tcp.flags.ns
```c
ECN concealment protection(RFC 3540)
    
tcp.flags.ns == 0，Not set
```
tcp.flags.cwr
```c
Congestion Window Reduced(CWR)
    
tcp.flags.cwr == 0，Not set
```
tcp.flags.ecn
```c
ECN-Echo

tcp.flags.ecn == 0，Not set
```
tcp.flags.urg
```c
Urgent

tcp.flags.urg == 0，Not set
```
tcp.flags.ack
```c
Ackonwledgment

tcp.flags.ack == 1，Set
```
tcp.flags.push
```c
Push

tcp.flags.push == 0，Not set
```
tcp.flags.reset
```c
Reset

tcp.flags.reset == 0，Not set
```
tcp.flags.syn
```c
Syn

tcp.flags.syn == 0，Not set
```
tcp.flags.fin
```c
Fin

tcp.flags.fin == 0，Not set
```
tcp.flags.str
```c
TCP Flags

tcp.flags.str == "\xc2\xb7\xc2\xb7\xc2\xb7\xc2\xb7\xc2\xb7\xc2\xb7\xc2\xb7A\xc2\xb7\xc2\xb7\xc2\xb7\xc2\xb7"，ACK
```
tcp.window_size_value
```c
The window size value from the TCP header

tcp.window_size_value == 32709
```
tcp.window_size
```c
The scaled window size(if scaling has been used)
    
tcp.window_size == 32709
```
tcp.window_size_scalefactor
```c
The window size scaling factor(-1 when unknown,-2 when no scaling is used)
    
tcp.window_size_scalefactor == -1，unknown
tcp.window_size_scalefactor == -2，no window scaling used
tcp.window_size_scalefactor == 256
```
tcp.checksum
```c
TCP checksum

tcp.checksum == 0x3305
```
tcp.checksum.status
```c
Checksum Status

tcp.checksum.status == "Unverified"
```
tcp.checksum_bad.expert
```c
Bad checksum
```
tcp.urgent_pointer
```c
Urgent pointer

tcp.urgent_pointer == 0
```
tcp.analysis
```c
This frame has sone of the TCP analysis shown

tcp.analysis
```
tcp.analysis.ack_lost_segment
```c
ACKed segment that wasn't captured(common at capture start)
```
tcp.analysis.ack_rtt
```c
The RTT to ACK the segment was

tcp.analysis.ack_rtt == 0.0001
```
tcp.analysis.acks_frame
```c
This is an ACK to the segment in frame

tcp.analysis.acks_frame == 100
```
tcp.analysis.bytes_in_flight
```c
How many bytes are now in flight for this connection

tcp.analysis.bytes_in_flight == 12
```
tcp.analysis.duplicate_ack
```c
Duplicate ACK
```
tcp.analysis.duplicate_ack_frame
```c
Duplicate to the ACK in frame

tcp.analysis.duplicate_ack_frame == 114
```
tcp.analysis.duplicate_ack_num
```c
Duplicate ACK #

tcp.analysis.duplicate_ack_num == 1
```
tcp.analysis.fast_retransmission
```c
This frame is a (suspected) fast retransmission
```
tcp.analysis.flags
```c
TCP Analysis Flags
```
tcp.analysis.initial_rtt
```c
iRTT

tcp.analysis.initial_rtt <= 0.020000
```
tcp.analysis.keep_alive
```c
TCP keep-alive segment
```
tcp.analysis.keep_alive_ack
```c
ACK to a TCP keep-alive segment
```
tcp.analysis.lost_segment
```c
Previous segment(s) not captured (common at capture start)
```
tcp.analysis.out_of_order
```c
This frame is a (suspected) retransmission
```
tcp.analysis.push_bytes_sent
```c
How many bytes have been sent since the last PSH flag

tcp.analysis.push_bytes_sent == 12
```
tcp.analysis.retransmission
```c
This frame is a (suspected) retransmission
```
tcp.analysis.reused_ports
```c
A new tcp session is started with the same ports as an earlier session in this trace
```
tcp.analysis.rto
```c
The RTO for this segment was

tcp.analysis.rto <= 1
```
tcp.analysis.rto_frame
```c
RTO based on delta from frame

tcp.analysis.rto_frame == 100
```
tcp.analysis.spurious_retransmission
```c
This frame is a (suspected) spurious retransmission
```
tcp.analysis.tfo_syn
```c
TCP SYN with TFO Cookie
```
tcp.analysis.window_full
```c
TCP window specified by the receiver is now completely full
```
tcp.analysis.window_update
```c
TCP window update
```
tcp.analysis.zero_window
```c
TCP Zero Window segment
```
tcp.analysis.zero_window_probe
```c
TCP Zero Window Probe
```
tcp.analysis.zero_window_probe_ack
```c
ACK to a TCP Zero Window Probe
```
tcp.connection.fin
```c
Connection finish(FIN)
```
tcp.connection.rst
```c
Connection reset(RST)
```
tcp.connection.sack
```c
Connection establish acknowledge(SYN+ACK)
```
tcp.connection.syn
```c
Connection establish request(SYN)
```
tcp.fin_retransmission
```c
Retransmission of FIN from frame
```
tcp.option.len.invalid
```c
Invalid length for option
```
tcp.option_len
```c
Length
```
tcp.options
```c
TCP Options

tcp.options
```
tcp.options.echo_value
```c
TCP Echo Option
```
tcp.options.mss.absent
```c
The SYN packet does not contain a MSS option
```
tcp.options.present
```c
The non-SYN packet does contain a MSS option
```
tcp.options.sack.count
```c
TCP SACK Count
```
tcp.options.sack_le
```c
TCP SACK Left Edge
```
tcp.options.sack_re
```c
TCP SACK Right Edge
```
tcp.options.tfo
```c
TCP Fast Open
```
tcp.options.tfo.cookie
```c
Fast Open Cookie
```
tcp.options.tfo.request
```c
Fast Open Cookie Request
```
tcp.options.md5
```c
TCP MD5 signature
```
tcp.time_relative
```c
Time relative to first frame in this TCP stream
```
tcp.time_delta
```c
Time delta from previous frame in this TCP stream
```
tcp.payload
```c
The TCP payload of this packet
```
tcp.pdu.last_frame
```c
Last frame of this PDU
```
tcp.pdu.size
```c
PDU Size
```
tcp.pdu.time
```c
Time until the last segment of this PDU
```
tcp.reassembled.data
```c
Reassembled TCP Data
```
tcp.reassembled.length
```c
Reassembled TCP length
```
tcp.reassembled_in
```c
Reassembled PDU in frame
```
tcp.reset_cause
```c
Reset cause
```
tcp.segment
```c
TCP segment

tcp.segment
```
tcp.segment.count
```c
Segment count
```
tcp.segment.error
```c
Reassembling error
```
tcp.segment_data
```c
TCP segment data
```
tcp.segments
```c
Reassembled TCP segments
```
data
```c
data · Data
```


## UDP
udp
```c
User Datagram Protocol

udp
```
udp.srcport
```c
Source Port

udp.srcport == 53354
```
udp.dstport
```c
Destination Port

udp.dstport == 22313
```
udp.length
```c
Length

udp.length == 16
```
udp.checksum
```c
UDP Checksum

udp.checksum == 0xb4c0
```
udp.checksum.status
```c
Checksum Status

udp.checksum.status == "Unverified"
```
udp.checksum.bad
```c
Bad checksum
```
udp.stream
```c
Stream index

udp.stream == 34
```
udp.time_relative
```c
Time relative to first frame in this UDP stream
```
udp.time_delta
```c
Time delta from previous frame in this UDP stream
```
udp.pdu.size
```c
PDU Size
```
data
```c
Data

data
```


